<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Sheets API Example</title>
    <script src="https://apis.google.com/js/api.js"></script>
</head>
<body>
    <script>
        function init() {
            gapi.client.init({
                apiKey: 'SUA_CHAVE_DE_API',
                discoveryDocs: ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
            }).then(function() {
                // Chame a função para criar uma nova planilha
                createNewSheet();
            });
        }

        function createNewSheet() {
            // Nome da nova planilha
            var sheetName = 'NovaPlanilha';

            // Solicitar a criação de uma nova planilha
            gapi.client.sheets.spreadsheets.create({
                properties: {
                    title: sheetName
                }
            }).then(function(response) {
                var spreadsheetId = response.result.spreadsheetId;

                // Agora você pode adicionar dados à nova planilha, por exemplo:
                appendDataToSheet(spreadsheetId);
            });
        }

        function appendDataToSheet(spreadsheetId) {
            // Adicione código para alimentar dados na planilha usando o ID da planilha
            // Exemplo: Adicionar dados à primeira folha da planilha
            gapi.client.sheets.spreadsheets.values.append({
                spreadsheetId: spreadsheetId,
                range: 'Sheet1', // Nome da folha
                valueInputOption: 'USER_ENTERED',
                values: [['Nome', 'Idade'], ['João', 25], ['Maria', 30]]
            }).then(function(response) {
                console.log('Dados adicionados com sucesso à planilha:', response);
            });
        }

        gapi.load('client', init);
    </script>
</body>
</html>
